"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){function a(e){return e.indexOf("=")>-1?e.split("=")[1]:e}function t(){new $LvAlert({theme:"toast",face:"sad",px:!0,timeout:2e3,message:"该筛选项无数据，已恢复至默认选项！"})}function r(e){return 1===e.length?"0"+e:e}function c(e){return 2===e.length&&0===e.indexOf(0)?e.substring(1):e}function s(){var e=new Date;return e.setMonth(e.getMonth()+4),e.setDate(0),e}function o(e){var a=new Date,t=s(),o=[a.getFullYear(),a.getMonth()+1,a.getDate()],l=$("#"+searchType+"_startDate").val(),i=$("#"+searchType+"_endDate").val();2===e&&i?o=[i.substring(0,4),c(i.substring(4,6)),c(i.substring(6))]:l&&(o=[l.substring(0,4),c(l.substring(4,6)),c(l.substring(6))]);var n={title:"",isActive:!0,extraParam:{name:"date",range:[a.getFullYear(),t.getFullYear()],align:["center","center","center"],width:[30,30,30],defaultValue:o}};Fe=new SpinWheel,Fe.setData(n),Fe.setCancelAction(function(){$(".start-time-mask").hide()}),Fe.setDoneAction(function(){var c=Fe.getSelectedValues(),s=c.values[0].replace("年",""),o=c.values[1].replace("月",""),n=c.values[2].replace("日",""),d=new Date(s,o-1,n),p=new Date(a.getFullYear(),a.getMonth(),a.getDate());if(o=r(o),n=r(n),2===e){if(t<d)return new $LvAlert({theme:"toast",face:"sad",px:!0,timeout:1500,message:"最晚出发时间不能超过当前3个月！"}),void $(".start-time-mask").hide();if(l){var h=new Date(l.substring(0,4),l.substring(4,6)-1,l.substring(6));if(d<h)return new $LvAlert({theme:"toast",face:"sad",px:!0,timeout:1500,message:"最晚出发时间必须大于最早出发时间！"}),void $(".start-time-mask").hide()}$("#"+searchType+"_startTime2").text(s+"-"+o+"-"+n),$("#"+searchType+"_endDate").val(s+o+n)}else{if(t<d)return new $LvAlert({theme:"toast",face:"sad",px:!0,timeout:1500,message:"最早出发时间不能超过当前3个月！"}),void $(".start-time-mask").hide();if(d<p)return new $LvAlert({theme:"toast",face:"sad",px:!0,timeout:1500,message:"最早出发时间不能小于当前日期！"}),void $(".start-time-mask").hide();if(i){var y=new Date(i.substring(0,4),i.substring(4,6)-1,i.substring(6));if(d>y)return new $LvAlert({theme:"toast",face:"sad",px:!0,timeout:1500,message:"最早出发时间必须小于最晚出发时间！"}),void $(".start-time-mask").hide()}$("#"+searchType+"_startTime1").text(s+"-"+o+"-"+n),$("#"+searchType+"_startDate").val(s+o+n)}$("#"+searchType+'_monthUl li[data-code=""]').addClass("selected").siblings().removeClass("selected"),$("#"+searchType+"_startMonths").val(""),$(".start-time-mask").hide(),F("item",1)}),Fe.open()}function l(e){$(".start-time-mask").show(),o(e)}function i(e){$(e).attr("data-code")?($(e).toggleClass("selected"),$("#"+searchType+"_monthUl li.selected").length>0?$("#"+searchType+'_monthUl li[data-code=""]').removeClass("selected"):$("#"+searchType+'_monthUl li[data-code=""]').addClass("selected")):$("#"+searchType+'_monthUl li[data-code=""]').addClass("selected").siblings().removeClass("selected"),d();var a=$("#"+searchType+'_monthUl li.selected[data-code != ""]'),t=a.length,r=[];if(t>0){for(var c=0;c<t;c++)r.push($(a[c]).data("code").replace(/startMonths=/g,""));$("#"+searchType+"_startMonths").val(r.join(","))}else $("#"+searchType+"_startMonths").val("");F("item",1)}function n(e){if(e.classList.contains("opend")){e.classList.remove("opend");var a=document.querySelector("#"+searchType+"_monthUl");a.style.maxHeight="80px"}else{e.classList.add("opend");var a=document.querySelector("#"+searchType+"_monthUl"),t=a.scrollHeight;a.style.maxHeight=t+"px"}}function d(){$("#"+searchType+"_startTime1").text("最早出发"),$("#"+searchType+"_startTime2").text("最晚出发"),$("#"+searchType+"_startDate").val(""),$("#"+searchType+"_endDate").val("")}function p(e,a){return Number(e)-Number(a)}function h(){new $LvAlert({theme:"toast",face:"sad",px:!0,timeout:1500,message:"网络错误，请稍后重试！"})}function y(e,a){location.host.indexOf("lvmama")>-1?_(e,a,".lvmama.com","/"):_(e,a,"","/")}function _(e,a,t,r){var c=t,s=r;c=c?";domain="+c:"",s=s?";path="+s:"";var o=new Date;o.setTime(o.getTime()+216e5),document.cookie=e+"="+a+c+s+";expires="+o}function u(e,a){var t=parseInt($("#"+searchType+"_page").val())+1,r=$("#"+searchType+"_promote").val(),c={keyword:$("#keyword").val(),homeSearch:$("#homeSearch").val(),channel:$("#channel").val(),latitude:latitude,longitude:longitude,ajax:!0};switch(needShare&&(c.from="league"),c[searchType+"_page"]=t,c[searchType+"_promote"]=r,e&&(c[searchType+"_page"]=1),searchType){case searchTypes.r:c[searchType+"_sort"]=$("#"+searchType+"_sort").val(),c[searchType+"_routeNum"]=$("#"+searchType+"_routeNum").val(),c[searchType+"_startMonths"]=$("#"+searchType+"_startMonths").val(),c[searchType+"_startDate"]=$("#"+searchType+"_startDate").val(),c[searchType+"_endDate"]=$("#"+searchType+"_endDate").val(),c[searchType+"_subjectId"]=$("#"+searchType+"_subjectId").val(),c[searchType+"_districtId"]=$("#"+searchType+"_districtId").val(),c[searchType+"_price"]=$("#"+searchType+"_price").val(),c[searchType+"_routeDestId"]=$("#"+searchType+"_routeDestId").val(),c[searchType+"_viewPiont"]=$("#"+searchType+"_viewPiont").val(),c[searchType+"_productType"]=$("#"+searchType+"_productType").val(),c[searchType+"_hotelStar"]=$("#"+searchType+"_hotelStar").val(),c[searchType+"_playMethod"]=$("#"+searchType+"_playMethod").val(),c[searchType+"_traffic"]=$("#"+searchType+"_traffic").val(),c[searchType+"_category"]=$("#"+searchType+"_category").val(),c[searchType+"_productGrade"]=$("#"+searchType+"_productGrade").val(),c[searchType+"_crowdLvTuTagId"]=$("#"+searchType+"_crowdLvTuTagId").val(),c[searchType+"_brandLvTuTagId"]=$("#"+searchType+"_brandLvTuTagId").val(),c[searchType+"_hotelBrandId"]=$("#"+searchType+"_hotelBrandId").val(),c[searchType+"_recommendDeparture"]=e?1:0;break;case searchTypes.lv:c[searchType+"_sort"]=$("#"+searchType+"_sort").val(),c[searchType+"_routeNum"]=$("#"+searchType+"_routeNum").val(),c[searchType+"_subjectId"]=$("#"+searchType+"_subjectId").val(),c[searchType+"_viewPiont"]=$("#"+searchType+"_viewPiont").val(),c[searchType+"_routeDestId"]=$("#"+searchType+"_routeDestId").val();break;case searchTypes.s:c[searchType+"_sort"]=$("#"+searchType+"_sort").val(),c[searchType+"_routeNum"]=$("#"+searchType+"_routeNum").val(),c[searchType+"_startMonths"]=$("#"+searchType+"_startMonths").val(),c[searchType+"_startDate"]=$("#"+searchType+"_startDate").val(),c[searchType+"_endDate"]=$("#"+searchType+"_endDate").val(),c[searchType+"_subjectId"]=$("#"+searchType+"_subjectId").val(),c[searchType+"_districtId"]=$("#"+searchType+"_districtId").val(),c[searchType+"_price"]=$("#"+searchType+"_price").val(),c[searchType+"_routeDestId"]=$("#"+searchType+"_routeDestId").val(),c[searchType+"_viewPiont"]=$("#"+searchType+"_viewPiont").val(),c[searchType+"_productType"]=$("#"+searchType+"_productType").val(),c[searchType+"_hotelStar"]=$("#"+searchType+"_hotelStar").val(),c[searchType+"_category"]=$("#"+searchType+"_category").val(),c[searchType+"_productGrade"]=$("#"+searchType+"_productGrade").val(),c[searchType+"_crowdLvTuTagId"]=$("#"+searchType+"_crowdLvTuTagId").val(),c[searchType+"_brandLvTuTagId"]=$("#"+searchType+"_brandLvTuTagId").val(),c[searchType+"_hotelBrandId"]=$("#"+searchType+"_hotelBrandId").val();break;case searchTypes.f:c[searchType+"_sort"]=$("#"+searchType+"_sort").val(),c[searchType+"_routeNum"]=$("#"+searchType+"_routeNum").val(),c[searchType+"_startMonths"]=$("#"+searchType+"_startMonths").val(),c[searchType+"_startDate"]=$("#"+searchType+"_startDate").val(),c[searchType+"_endDate"]=$("#"+searchType+"_endDate").val(),c[searchType+"_subjectId"]=$("#"+searchType+"_subjectId").val(),c[searchType+"_districtId"]=$("#"+searchType+"_districtId").val(),c[searchType+"_price"]=$("#"+searchType+"_price").val(),c[searchType+"_routeDestId"]=$("#"+searchType+"_routeDestId").val(),c[searchType+"_viewPiont"]=$("#"+searchType+"_viewPiont").val(),c[searchType+"_productType"]=$("#"+searchType+"_productType").val(),c[searchType+"_hotelStar"]=$("#"+searchType+"_hotelStar").val(),c[searchType+"_playMethod"]=$("#"+searchType+"_playMethod").val(),c[searchType+"_traffic"]=$("#"+searchType+"_traffic").val(),c[searchType+"_category"]=$("#"+searchType+"_category").val(),c[searchType+"_productGrade"]=$("#"+searchType+"_productGrade").val(),c[searchType+"_crowdLvTuTagId"]=$("#"+searchType+"_crowdLvTuTagId").val(),c[searchType+"_brandLvTuTagId"]=$("#"+searchType+"_brandLvTuTagId").val(),c[searchType+"_hotelBrandId"]=$("#"+searchType+"_hotelBrandId").val();break;case searchTypes.p:c[searchType+"_sort"]=$("#"+searchType+"_sort").val(),c[searchType+"_routeNum"]=$("#"+searchType+"_routeNum").val(),c[searchType+"_startMonths"]=$("#"+searchType+"_startMonths").val(),c[searchType+"_startDate"]=$("#"+searchType+"_startDate").val(),c[searchType+"_endDate"]=$("#"+searchType+"_endDate").val(),c[searchType+"_subjectId"]=$("#"+searchType+"_subjectId").val(),c[searchType+"_districtId"]=$("#"+searchType+"_districtId").val(),c[searchType+"_price"]=$("#"+searchType+"_price").val(),c[searchType+"_routeDestId"]=$("#"+searchType+"_routeDestId").val(),c[searchType+"_viewPiont"]=$("#"+searchType+"_viewPiont").val(),c[searchType+"_productType"]=$("#"+searchType+"_productType").val(),c[searchType+"_playMethod"]=$("#"+searchType+"_playMethod").val(),c[searchType+"_traffic"]=$("#"+searchType+"_traffic").val();break;case searchTypes.g:c[searchType+"_sort"]=$("#"+searchType+"_sort").val(),c[searchType+"_routeNum"]=$("#"+searchType+"_routeNum").val(),c[searchType+"_startMonths"]=$("#"+searchType+"_startMonths").val(),c[searchType+"_startDate"]=$("#"+searchType+"_startDate").val(),c[searchType+"_endDate"]=$("#"+searchType+"_endDate").val(),c[searchType+"_subjectId"]=$("#"+searchType+"_subjectId").val(),c[searchType+"_districtId"]=$("#"+searchType+"_districtId").val(),c[searchType+"_price"]=$("#"+searchType+"_price").val(),c[searchType+"_routeDestId"]=$("#"+searchType+"_routeDestId").val(),c[searchType+"_viewPiont"]=$("#"+searchType+"_viewPiont").val(),c[searchType+"_productType"]=$("#"+searchType+"_productType").val(),c[searchType+"_playMethod"]=$("#"+searchType+"_playMethod").val(),c[searchType+"_category"]=$("#"+searchType+"_category").val(),c[searchType+"_productGrade"]=$("#"+searchType+"_productGrade").val(),c[searchType+"_crowdLvTuTagId"]=$("#"+searchType+"_crowdLvTuTagId").val(),c[searchType+"_brandLvTuTagId"]=$("#"+searchType+"_brandLvTuTagId").val(),c[searchType+"_hotelBrandId"]=$("#"+searchType+"_hotelBrandId").val(),c[searchType+"_traffic"]=$("#"+searchType+"_traffic").val();break;case searchTypes.l:c[searchType+"_sort"]=$("#"+searchType+"_sort").val(),c[searchType+"_routeNum"]=$("#"+searchType+"_routeNum").val(),c[searchType+"_startMonths"]=$("#"+searchType+"_startMonths").val(),c[searchType+"_startDate"]=$("#"+searchType+"_startDate").val(),c[searchType+"_endDate"]=$("#"+searchType+"_endDate").val(),c[searchType+"_subjectId"]=$("#"+searchType+"_subjectId").val(),c[searchType+"_districtId"]=$("#"+searchType+"_districtId").val(),c[searchType+"_price"]=$("#"+searchType+"_price").val(),c[searchType+"_routeDestId"]=$("#"+searchType+"_routeDestId").val(),c[searchType+"_viewPiont"]=$("#"+searchType+"_viewPiont").val(),c[searchType+"_productType"]=$("#"+searchType+"_productType").val(),c[searchType+"_category"]=$("#"+searchType+"_category").val(),c[searchType+"_productGrade"]=$("#"+searchType+"_productGrade").val(),c[searchType+"_crowdLvTuTagId"]=$("#"+searchType+"_crowdLvTuTagId").val(),c[searchType+"_brandLvTuTagId"]=$("#"+searchType+"_brandLvTuTagId").val(),c[searchType+"_hotelBrandId"]=$("#"+searchType+"_hotelBrandId").val();break;case searchTypes.y:c[searchType+"_sort"]=$("#"+searchType+"_sort").val(),c[searchType+"_line"]=$("#"+searchType+"_line").val(),c[searchType+"_start"]=$("#"+searchType+"_start").val(),c[searchType+"_brand"]=$("#"+searchType+"_brand").val(),c[searchType+"_month"]=$("#"+searchType+"_month").val(),c[searchType+"_district"]=$("#"+searchType+"_district").val(),c[searchType+"_ship"]=$("#"+searchType+"_ship").val();break;case searchTypes.t:c[searchType+"_sort"]=$("#"+searchType+"_sort").val(),c[searchType+"_todayTicketFlag"]=$("#"+searchType+"_todayOrderableFlag").val(),c[searchType+"_province"]=$("#"+searchType+"_provinceId").val(),c[searchType+"_city"]=$("#"+searchType+"_cityId").val(),c[searchType+"_county"]=$("#"+searchType+"_countyId").val(),c[searchType+"_subject"]=$("#"+searchType+"_subjectId").val(),c[searchType+"_activeFlag"]=$("#"+searchType+"_activeFlag").val(),c[searchType+"_promotionFlag"]=$("#"+searchType+"_promotionFlag").val(),c[searchType+"_ticketStar"]=$("#"+searchType+"_starLevel").val();break;case searchTypes.h:c[searchType+"_sort"]=$("#"+searchType+"_sort").val(),c[searchType+"_price"]=$("#"+searchType+"_price").val(),c[searchType+"_hotelStar"]=$("#"+searchType+"_hotelStar").val(),c[searchType+"_landMarkIds"]=$("#"+searchType+"_landMarkIds").val(),c[searchType+"_facilities"]=$("#"+searchType+"_facilities").val();break;case searchTypes.v:c[searchType+"_sort"]=$("#"+searchType+"_sort").val(),c[searchType+"_visaType"]=$("#"+searchType+"_visaType").val(),c[searchType+"_rangeId"]=$("#"+searchType+"_rangeId").val();break;case searchTypes.u:c[searchType+"_sort"]=$("#"+searchType+"_sort").val(),c[searchType+"_province"]=$("#"+searchType+"_province").val(),c[searchType+"_city"]=$("#"+searchType+"_city").val(),c[searchType+"_county"]=$("#"+searchType+"_county").val(),c[searchType+"_playMethodTypeIds"]=$("#"+searchType+"_playMethodTypeIds").val();break;case searchTypes.a:c[searchType+"_sort"]=$("#"+searchType+"_sort").val(),c[searchType+"_routeNum"]=$("#"+searchType+"_routeNum").val(),c[searchType+"_startMonths"]=$("#"+searchType+"_startMonths").val(),c[searchType+"_startDate"]=$("#"+searchType+"_startDate").val(),c[searchType+"_endDate"]=$("#"+searchType+"_endDate").val(),c[searchType+"_subjectId"]=$("#"+searchType+"_subjectId").val(),c[searchType+"_districtId"]=$("#"+searchType+"_districtId").val(),c[searchType+"_price"]=$("#"+searchType+"_price").val(),c[searchType+"_routeDestId"]=$("#"+searchType+"_routeDestId").val(),c[searchType+"_viewPiont"]=$("#"+searchType+"_viewPiont").val(),c[searchType+"_productType"]=$("#"+searchType+"_productType").val(),c[searchType+"_playMethod"]=$("#"+searchType+"_playMethod").val(),c[searchType+"_category"]=$("#"+searchType+"_category").val(),c[searchType+"_productGrade"]=$("#"+searchType+"_productGrade").val(),c[searchType+"_crowdLvTuTagId"]=$("#"+searchType+"_crowdLvTuTagId").val(),c[searchType+"_brandLvTuTagId"]=$("#"+searchType+"_brandLvTuTagId").val(),c[searchType+"_hotelBrandId"]=$("#"+searchType+"_hotelBrandId").val()}if(searchType===searchTypes.h)Be(t);else{var s=searchType;$.ajax({url:"/tour/"+("ship"===s?"youlun":s),data:c,type:"GET",beforeSend:function(){$("#"+s+"_onbuttom").show()},success:function(e){e.html.indexOf("search-null")>-1?h():($("#"+s+"_container .masterplate-list").append(e.html),$("#"+s+"_page").val(t),Me(s,t),a&&a())},error:function(){h()},complete:function(){$("#"+s+"_onbuttom").hide(),Le=!1,Pe("filter")}})}}function v(e,a,t,r){a=a||"",t=t||"";var c=document.createElement("div"),s="",o="",l="最早出发",i="最晚出发";a&&(s=a,l=a.substring(0,4)+"-"+a.substring(4,6)+"-"+a.substring(6,8)),t&&(o=t,i=t.substring(0,4)+"-"+t.substring(4,6)+"-"+t.substring(6,8));var n='<li data-code="出发月份" id="'+searchType+'_startMonthPanel"><h3 class="filter-title ';r.length>4&&(n+="more"),n+='"><span>出发月份</span>';var d="",p="";if(r.length>4){if(d+='<div class="filter-more ',$("#"+searchType+"_startMonthPanel").length>0&&$("#"+searchType+"_startMonthPanel").parent().parent().hasClass("on")&&$("#"+searchType+"_startMonthPanel .filter-more").hasClass("opend")){d+="opend";var h=1;h=r.length%4>0?parseInt(r.length/4)+1:r.length/4;var y=36*h+8*(h-1);p="max-height: "+y+"px;"}d+='" onclick="monthMoreClick(this);"></div>'}d+='</h3><ul style="'+p+'" class="filter-sub-ul" id="'+searchType+'_monthUl">';var _=[];r.forEach(function(a){var t="";a.code||0!==e.length?e.indexOf(a.code)>=0&&(t="selected",_.push(a.value)):t="selected",d+='<li data-code="'+a.code+'" class="'+t+'" onclick="monthClick(this);"><div><span>'+a.value+"</span></div></li>"}),s&&!o?_=[l+"~不限"]:!s&&o?_=["不限~"+i]:s&&o&&(_=[l+"~"+i]);var u="<i>"+_.join("、")+"</i>";return d+="</ul>",d+='<div class="datePanel"><h4>自定义出游日期</h4>',d+='<div class="date-outer"><div class="date-inner-1" id="'+searchType+'_startTime1" onclick="showStartTime(1);">'+l+'</div><div class="date-inner-2">—</div><div class="date-inner-3" id="'+searchType+'_startTime2" onclick="showStartTime(2);">'+i+"</div></div></div>",d+="</li>",n=n+u+d,c.innerHTML=n,c.firstChild}function T(){$("#search_"+searchType+"_top li").removeClass("active");var e="";["route","scenictour","freetour","play","group","local"].indexOf(searchType)>=0?e="playMethod":"localplay"===searchType&&(e="playMethodTypeIds");var a=$("#"+searchType+"_"+e).val();a&&a.split(",").forEach(function(a){$("#search_"+searchType+'_top li[data-code="'+e+"="+a+'"]').addClass("active")});var t=$("#"+searchType+"_promote").val();t&&$("#search_"+searchType+'_top li[data-code="'+t+'"]').addClass("active");var r=$("#group_brandLvTuTagId").val();"group"==searchType&&r&&$('#search_group_top li[data-code="brandLvTuTagId='+r+'"]').addClass("active")}function m(e,a,t,r,c){var s,o,l,i,n;try{l=t?t.toString():""}catch(d){console.error(d),l=""}try{i=r?JSON.parse(r):""}catch(d){console.error(d),i=""}try{n=JSON.parse(c)}catch(d){console.error(d),n={}}try{s=JSON.parse(e)}catch(d){console.error(d),s=[]}try{o=JSON.parse(a)}catch(d){console.error(d),o=[]}Oe=new FilterBar([{tabName:"排序",selectedData:l,replace:!0,data:[{itemName:"驴妈妈推荐",itemCode:"","default":!0},{itemName:"价格从低到高",itemCode:"3","default":!1},{itemName:"价格从高到低",itemCode:"2","default":!1},{itemName:"评价最高",itemCode:"27","default":!1}],callback:f},{tabName:"游玩天数",selectedData:i,data:s[0]&&s[0].items?s[0].items:[],callback:g},{tabName:"筛选",selectedData:n,data:o,callback:S}])}function f(e){var t=e.selected,r=e.type;"confirm"===r&&($("#"+searchType+"_sort").val(a(t)),F())}function g(e){var t=e.selected,r=e.type;"confirm"===r&&($("#"+searchType+"_routeNum").val(a(t)),F())}function S(e){var a=e.selected,t=e.type;"confirm"===t&&($("#"+searchType+"_subjectId").val(""),$("#"+searchType+"_viewPiont").val(""),$("#"+searchType+"_routeDestId").val(""),a&&Object.keys(a).length&&Object.keys(a).forEach(function(e){var t=e,r=a[e];"主题"==t?$("#"+searchType+"_subjectId").val(r.join(",").replace(/subjectId=/g,"")):"景点"==t?$("#"+searchType+"_viewPiont").val(r.join(",").replace(/viewPiont=/g,"")):"包含地区"==t&&$("#"+searchType+"_routeDestId").val(r.join(",").replace(/destId=/g,""))}),F())}function b(e,a,t,r,c){var s,o,l,i,n,d,p,h,y;try{i=JSON.parse(e.routeNumConditions)}catch(_){console.error(_),i=[]}try{l=JSON.parse(e.conditions)}catch(_){console.error(_),l=[]}try{n=JSON.parse(e.sortSelected)}catch(_){console.error(_),n=""}try{d=JSON.parse(e.routeNumSelected)}catch(_){console.error(_),d={}}try{p=JSON.parse(e.selected)}catch(_){console.error(_),p={}}try{h=JSON.parse(e.destIdConditions)}catch(_){console.error(_),h=[]}try{y=JSON.parse(e.destIdSelected)}catch(_){console.error(_),y={}}try{s=d["出发月份"]||[]}catch(_){console.error(_),s=[]}try{o=JSON.parse(e.startDateConditions)}catch(_){console.error(_),o=[]}var u=v(s,e.startDateSelected,e.endDateSelected,o);(e.startDateSelected||e.endDateSelected)&&(d["出发月份"]=e.startDateSelected+e.endDateSelected),i.forEach(function(e){"出发月份"===e.groupCode&&(e.groupName="出发日期",e.items=u)});var T="<p>确认</p>",m=$("#"+a+"_totalCount").val();m&&(T+="<sub>全部"+m+"条线路</sub>");var f=[{tabName:"综合排序",selectedData:n,replace:!0,data:[{itemName:"综合排序",itemCode:"","default":!0},{itemName:"新品推荐",itemCode:"37","default":!1},{itemName:"价格从低到高",itemCode:"3","default":!1},{itemName:"价格从高到低",itemCode:"2","default":!1},{itemName:"好评度从高到低",itemCode:"27","default":!1}],callback:D},{tabName:"日期天数",selectedData:d,customSelected:!!(s.length||e.startDateSelected||e.endDateSelected),data:i,confirmHtml:T,callback:C},{tabName:"包含地区",selectedData:y,data:h,callback:k},{tabName:"筛选",selectedData:p,data:l,confirmHtml:T,callback:I}];t?Oe&&Oe.reset({config:f,type:r,ext:c}):Oe=new FilterBar(f)}function C(e){var a=e.selected,t=e.type,r=e.ext,c="",s="",o="";if("confirm"===t||"item"===t)c=$("#"+searchType+"_startMonths").val(),s=$("#"+searchType+"_startDate").val(),o=$("#"+searchType+"_endDate").val();else if("cancel"===t){try{var l=JSON.parse(filterParams[searchType+"_routeNumSelected"])["出发月份"];l&&(c=l.map(function(e){return e.replace("startMonths=","")}).join(","))}catch(i){console.error(i)}s=filterParams[searchType+"_startDateSelected"],o=filterParams[searchType+"_endDateSelected"]}$("#"+searchType+"_routeNum").val(""),$("#"+searchType+"_startMonths").val(""),$("#"+searchType+"_startDate").val(""),$("#"+searchType+"_endDate").val(""),a&&Object.keys(a).length&&Object.keys(a).forEach(function(e){var t=e,r=a[e];"游玩天数"==t&&$("#"+searchType+"_routeNum").val(r.join(",").replace(/routeNum=/g,""))}),$("#"+searchType+"_startMonths").val(c),$("#"+searchType+"_startDate").val(s),$("#"+searchType+"_endDate").val(o),F(t,r)}function k(e){var a=e.selected,t=e.type,r=e.ext;$("#"+searchType+"_routeDestId").val(a.replace(/destId=/g,"")),F(t,r)}function I(e){var a=e.selected,t=e.type,r=e.ext;$("#"+searchType+"_subjectId").val(""),$("#"+searchType+"_viewPiont").val(""),$("#"+searchType+"_price").val(""),$("#"+searchType+"_districtId").val(""),$("#"+searchType+"_productType").val(""),$("#"+searchType+"_hotelStar").val(""),$("#"+searchType+"_category").val(""),$("#"+searchType+"_productGrade").val(""),$("#"+searchType+"_crowdLvTuTagId").val(""),$("#"+searchType+"_brandLvTuTagId").val(""),$("#"+searchType+"_hotelBrandId").val(""),a&&Object.keys(a).length&&Object.keys(a).forEach(function(e){var t=e,r=a[e];"出发地"==t?$("#"+searchType+"_districtId").val(r.join(",").replace(/districtId=/g,"")):"景点"==t?$("#"+searchType+"_viewPiont").val(r.join(",").replace(/viewPiont=/g,"")):"主题"==t?$("#"+searchType+"_subjectId").val(r.join(",").replace(/subjectId=/g,"")):"价格范围"==t?$("#"+searchType+"_price").val(r.join(",").replace(/price=/g,"")):"是否境外"==t?$("#"+searchType+"_productType").val(r.join(",").replace(/productType=/g,"")):"酒店星级"==t?$("#"+searchType+"_hotelStar").val(r.join(",").replace(/hotelStar=/g,"")):"旅游类型"==t?$("#"+searchType+"_category").val(r.join(",").replace(/category=/g,"")):"产品等级"==t?$("#"+searchType+"_productGrade").val(r.join(",").replace(/productGrade=/g,"")):"适用人群"==t?$("#"+searchType+"_crowdLvTuTagId").val(r.join(",").replace(/crowdLvTuTagId=/g,"")):"自主品牌"==t?$("#"+searchType+"_brandLvTuTagId").val(r.join(",").replace(/brandLvTuTagId=/g,"")):"酒店品牌"==t&&$("#"+searchType+"_hotelBrandId").val(r.join(",").replace(/hotelBrandId=/g,""))}),F(t,r)}function D(e){var t=e.selected,r=e.type,c=e.ext;$("#"+searchType+"_sort").val(a(t)),F(r,c)}function N(e,a,t,r,c){var s,o,l,i,n,d,p,h,y;try{i=JSON.parse(e.routeNumConditions)}catch(_){console.error(_),i=[]}try{l=JSON.parse(e.conditions)}catch(_){console.error(_),l=[]}try{n=JSON.parse(e.sortSelected)}catch(_){console.error(_),n=""}try{d=JSON.parse(e.routeNumSelected)}catch(_){console.error(_),d={}}try{p=JSON.parse(e.selected)}catch(_){console.error(_),p={}}try{h=JSON.parse(e.playMethodConditions)}catch(_){console.error(_),h=[]}try{y=JSON.parse(e.playMethodSelected)}catch(_){console.error(_),y=[]}try{s=d["出发月份"]||[]}catch(_){console.error(_),s=[]}try{o=JSON.parse(e.startDateConditions)}catch(_){console.error(_),o=[]}var u=v(s,e.startDateSelected,e.endDateSelected,o);i.forEach(function(e){"出发月份"===e.groupCode&&(e.groupName="出发日期",e.items=u)});var T=[{itemName:"综合排序",itemCode:"","default":!0},{itemName:"新品推荐",itemCode:"37","default":!1},{itemName:"价格从低到高",itemCode:"3","default":!1},{itemName:"价格从高到低",itemCode:"2","default":!1},{itemName:"好评度从高到低",itemCode:"27","default":!1}];searchType===searchTypes.f&&T.splice(1,1);var m="<p>确认</p>",f=$("#"+a+"_totalCount").val();f&&(m+="<sub>全部"+f+"条线路</sub>");var g=[{tabName:"综合排序",selectedData:n,replace:!0,data:T,callback:M},{tabName:"日期天数",selectedData:d,customSelected:!!(s.length||e.startDateSelected||e.endDateSelected),data:i,confirmHtml:m,callback:w},{tabName:"线路玩法",selectedData:y,data:h,multi:!0,confirmHtml:m,callback:j},{tabName:"筛选",selectedData:p,data:l,confirmHtml:m,callback:P}];t?Oe&&Oe.reset({config:g,type:r,ext:c}):Oe=new FilterBar(g,function(){Object.keys(d).length||y.length||Object.keys(p).length||h.length||$("#filter-tab-2").hide()})}function w(e){var a=e.selected,t=e.type,r=e.ext,c="",s="",o="";if("confirm"===t||"item"===t)c=$("#"+searchType+"_startMonths").val(),s=$("#"+searchType+"_startDate").val(),o=$("#"+searchType+"_endDate").val();else if("cancel"===t){try{var l=JSON.parse(filterParams[searchType+"_routeNumSelected"])["出发月份"];l&&(c=l.map(function(e){return e.replace("startMonths=","")}).join(","))}catch(i){console.error(i)}s=filterParams[searchType+"_startDateSelected"],o=filterParams[searchType+"_endDateSelected"]}$("#"+searchType+"_routeNum").val(""),$("#"+searchType+"_startMonths").val(""),$("#"+searchType+"_startDate").val(""),$("#"+searchType+"_endDate").val(""),a&&Object.keys(a).length&&Object.keys(a).forEach(function(e){var t=e,r=a[e];"游玩天数"==t&&$("#"+searchType+"_routeNum").val(r.join(",").replace(/routeNum=/g,""))}),$("#"+searchType+"_startMonths").val(c),$("#"+searchType+"_startDate").val(s),$("#"+searchType+"_endDate").val(o),F(t,r)}function j(e){var a=e.selected,t=e.type,r=e.ext;$("#"+searchType+"_playMethod").val(a.join(",").replace(/playMethod=/g,"")),F(t,r)}function P(e){var a=e.selected,t=e.type,r=e.ext;$("#"+searchType+"_subjectId").val(""),$("#"+searchType+"_viewPiont").val(""),$("#"+searchType+"_price").val(""),$("#"+searchType+"_districtId").val(""),$("#"+searchType+"_routeDestId").val(""),$("#"+searchType+"_productType").val(""),$("#"+searchType+"_hotelStar").val(""),$("#"+searchType+"_traffic").val(""),$("#"+searchType+"_category").val(""),$("#"+searchType+"_productGrade").val(""),$("#"+searchType+"_crowdLvTuTagId").val(""),$("#"+searchType+"_brandLvTuTagId").val(""),$("#"+searchType+"_hotelBrandId").val(""),a&&Object.keys(a).length&&Object.keys(a).forEach(function(e){var t=e,r=a[e];"主题"==t?$("#"+searchType+"_subjectId").val(r.join(",").replace(/subjectId=/g,"")):"景点"==t?$("#"+searchType+"_viewPiont").val(r.join(",").replace(/viewPiont=/g,"")):"价格范围"==t?$("#"+searchType+"_price").val(r.join(",").replace(/price=/g,"")):"出发地"==t?$("#"+searchType+"_districtId").val(r.join(",").replace(/districtId=/g,"")):"包含地区"==t?$("#"+searchType+"_routeDestId").val(r.join(",").replace(/destId=/g,"")):"是否境外"==t?$("#"+searchType+"_productType").val(r.join(",").replace(/productType=/g,"")):"酒店星级"==t?$("#"+searchType+"_hotelStar").val(r.join(",").replace(/hotelStar=/g,"")):"交通工具"==t?$("#"+searchType+"_traffic").val(r.join(",").replace(/traffic=/g,"")):"旅游类型"==t?$("#"+searchType+"_category").val(r.join(",").replace(/category=/g,"")):"产品等级"==t?$("#"+searchType+"_productGrade").val(r.join(",").replace(/productGrade=/g,"")):"适用人群"==t?$("#"+searchType+"_crowdLvTuTagId").val(r.join(",").replace(/crowdLvTuTagId=/g,"")):"自主品牌"==t?$("#"+searchType+"_brandLvTuTagId").val(r.join(",").replace(/brandLvTuTagId=/g,"")):"酒店品牌"==t&&$("#"+searchType+"_hotelBrandId").val(r.join(",").replace(/hotelBrandId=/g,""))}),F(t,r)}function M(e){var t=e.selected,r=e.type,c=e.ext;$("#"+searchType+"_sort").val(a(t)),F(r,c)}function O(e,a,t,r,c){var s,o,l,i,n,d,p,h,y;try{i=JSON.parse(e.routeNumConditions)}catch(_){console.error(_),i=[]}try{l=JSON.parse(e.conditions)}catch(_){console.error(_),l=[]}try{n=JSON.parse(e.sortSelected)}catch(_){console.error(_),n=""}try{d=JSON.parse(e.routeNumSelected)}catch(_){console.error(_),d={}}try{p=JSON.parse(e.selected)}catch(_){console.error(_),p={}}try{h=JSON.parse(e.playMethodConditions)}catch(_){console.error(_),h=[]}try{y=JSON.parse(e.playMethodSelected)}catch(_){console.error(_),y=[]}try{s=d["出发月份"]||[]}catch(_){console.error(_),s=[]}try{o=JSON.parse(e.startDateConditions)}catch(_){console.error(_),o=[]}var u=v(s,e.startDateSelected,e.endDateSelected,o);i.forEach(function(e){"出发月份"===e.groupCode&&(e.groupName="出发日期",e.items=u)});var T="<p>确认</p>",m=$("#"+a+"_totalCount").val();m&&(T+="<sub>全部"+m+"条线路</sub>");var f=[{tabName:"综合排序",selectedData:n,replace:!0,data:[{itemName:"综合排序",itemCode:"","default":!0},{itemName:"新品推荐",itemCode:"37","default":!1},{itemName:"价格从低到高",itemCode:"3","default":!1},{itemName:"价格从高到低",itemCode:"2","default":!1},{itemName:"好评度从高到低",itemCode:"27","default":!1}],callback:J},{tabName:"日期天数",selectedData:d,customSelected:!!(s.length||e.startDateSelected||e.endDateSelected),data:i,confirmHtml:T,callback:x},{tabName:"线路玩法",selectedData:y,data:h,multi:!0,confirmHtml:T,callback:L},{tabName:"筛选",selectedData:p,data:l,confirmHtml:T,callback:E}];t?Oe&&Oe.reset({config:f,type:r,ext:c}):Oe=new FilterBar(f,function(){Object.keys(d).length||y.length||Object.keys(p).length||h.length||$("#filter-tab-2").hide()})}function x(e){var a=e.selected,t=e.type,r=e.ext,c="",s="",o="";if("confirm"===t||"item"===t)c=$("#"+searchType+"_startMonths").val(),s=$("#"+searchType+"_startDate").val(),o=$("#"+searchType+"_endDate").val();else if("cancel"===t){try{var l=JSON.parse(filterParams[searchType+"_routeNumSelected"])["出发月份"];l&&(c=l.map(function(e){return e.replace("startMonths=","")}).join(","))}catch(i){console.error(i)}s=filterParams[searchType+"_startDateSelected"],o=filterParams[searchType+"_endDateSelected"]}$("#"+searchType+"_routeNum").val(""),$("#"+searchType+"_startMonths").val(""),$("#"+searchType+"_startDate").val(""),$("#"+searchType+"_endDate").val(""),a&&Object.keys(a).length&&Object.keys(a).forEach(function(e){var t=e,r=a[e];"游玩天数"==t&&$("#"+searchType+"_routeNum").val(r.join(",").replace(/routeNum=/g,""))}),$("#"+searchType+"_startMonths").val(c),$("#"+searchType+"_startDate").val(s),$("#"+searchType+"_endDate").val(o),F(t,r)}function L(e){var a=e.selected,t=e.type,r=e.ext;$("#"+searchType+"_playMethod").val(a.join(",").replace(/playMethod=/g,"")),F(t,r)}function E(e){var a=e.selected,t=e.type,r=e.ext;$("#"+searchType+"_subjectId").val(""),$("#"+searchType+"_viewPiont").val(""),$("#"+searchType+"_price").val(""),$("#"+searchType+"_districtId").val(""),$("#"+searchType+"_routeDestId").val(""),$("#"+searchType+"_productType").val(""),$("#"+searchType+"_category").val(""),$("#"+searchType+"_productGrade").val(""),$("#"+searchType+"_crowdLvTuTagId").val(""),$("#"+searchType+"_brandLvTuTagId").val(""),$("#"+searchType+"_hotelBrandId").val(""),a&&Object.keys(a).length&&Object.keys(a).forEach(function(e){var t=e,r=a[e];"主题"==t?$("#"+searchType+"_subjectId").val(r.join(",").replace(/subjectId=/g,"")):"景点"==t?$("#"+searchType+"_viewPiont").val(r.join(",").replace(/viewPiont=/g,"")):"价格范围"==t?$("#"+searchType+"_price").val(r.join(",").replace(/price=/g,"")):"出发地"==t?$("#"+searchType+"_districtId").val(r.join(",").replace(/districtId=/g,"")):"包含地区"==t?$("#"+searchType+"_routeDestId").val(r.join(",").replace(/destId=/g,"")):"是否境外"==t?$("#"+searchType+"_productType").val(r.join(",").replace(/productType=/g,"")):"旅游类型"==t?$("#"+searchType+"_category").val(r.join(",").replace(/category=/g,"")):"产品等级"==t?$("#"+searchType+"_productGrade").val(r.join(",").replace(/productGrade=/g,"")):"适用人群"==t?$("#"+searchType+"_crowdLvTuTagId").val(r.join(",").replace(/crowdLvTuTagId=/g,"")):"自主品牌"==t?$("#"+searchType+"_brandLvTuTagId").val(r.join(",").replace(/brandLvTuTagId=/g,"")):"酒店品牌"==t&&$("#"+searchType+"_hotelBrandId").val(r.join(",").replace(/hotelBrandId=/g,""))}),F(t,r)}function J(e){var t=e.selected,r=e.type,c=e.ext;$("#"+searchType+"_sort").val(a(t)),F(r,c)}function U(e,a){var t=$("#"+e+"_price").attr("seoCode");return["route","scenictour","freetour","play","group","local","around"].indexOf(e)>-1?t=t+"L"+a.split("&upperPrice=")[0].split("lowerPrice=")[1]+t+"U"+a.split("&upperPrice=")[1]:t+=a,t}function F(a,r,c){a=a||"confirm",Ae&&"item"===a&&Ae.abort();var s=$("#keyword").val(),o=$("#channel").val(),l=$("#homeSearch").val(),i=$("#removeTab").val(),n=$("#"+searchType+"_sort").val(),d=$("#"+searchType+"_routeNum").val(),y=$("#"+searchType+"_startMonths").val(),_=$("#"+searchType+"_startDate").val(),u=$("#"+searchType+"_endDate").val(),v=$("#"+searchType+"_subjectId").val(),m=$("#"+searchType+"_districtId").val(),f=$("#"+searchType+"_price").val(),g=$("#"+searchType+"_routeDestId").val(),S=$("#"+searchType+"_viewPiont").val(),b=$("#"+searchType+"_productType").val(),C=$("#"+searchType+"_hotelStar").val(),k=$("#"+searchType+"_playMethod").val(),I=$("#"+searchType+"_traffic").val(),D=$("#"+searchType+"_category").val(),N=$("#"+searchType+"_productGrade").val(),w=$("#"+searchType+"_crowdLvTuTagId").val(),j=$("#"+searchType+"_brandLvTuTagId").val(),P=$("#"+searchType+"_hotelBrandId").val(),M=$("#"+searchType+"_promote").val();
    if("confirm"===a){var O="";if("true"===isSEO){var x="";n&&(x=x+$("#"+searchType+"_sort").attr("seoCode")+n),d&&(x+=d.split(",").sort(p).map(function(e){return $("#"+searchType+"_routeNum").attr("seoCode")+e}).join("")),y&&(x+=y.split(",").sort(p).map(function(e){return $("#"+searchType+"_startMonths").attr("seoCode")+e}).join("")),_&&(x=x+$("#"+searchType+"_startDate").attr("seoCode")+_),u&&(x=x+$("#"+searchType+"_endDate").attr("seoCode")+u),void 0!=v&&""!=v&&(x+=v.split(",").sort(p).map(function(e){return $("#"+searchType+"_subjectId").attr("seoCode")+e}).join("")),m&&(x+=m.split(",").sort(p).map(function(e){return $("#"+searchType+"_districtId").attr("seoCode")+e}).join("")),f&&(x+=f.split(",").sort(p).map(function(e){return U(searchType,e)}).join("")),g&&(x+=g.split(",").sort(p).map(function(e){return $("#"+searchType+"_routeDestId").attr("seoCode")+e}).join("")),S&&(x+=S.split(",").sort(p).map(function(e){return $("#"+searchType+"_viewPiont").attr("seoCode")+e}).join("")),b&&(x+=b.split(",").sort(p).map(function(e){return $("#"+searchType+"_productType").attr("seoCode")+e}).join("")),C&&(x+=C.split(",").sort(p).map(function(e){return $("#"+searchType+"_hotelStar").attr("seoCode")+e}).join("")),k&&(x+=k.split(",").sort(p).map(function(e){return $("#"+searchType+"_playMethod").attr("seoCode")+e}).join("")),I&&(x+=I.split(",").sort(p).map(function(e){return $("#"+searchType+"_traffic").attr("seoCode")+e}).join("")),D&&(x+=D.split(",").sort(p).map(function(e){return $("#"+searchType+"_category").attr("seoCode")+e}).join("")),N&&(x+=N.split(",").sort(p).map(function(e){return $("#"+searchType+"_productGrade").attr("seoCode")+e}).join("")),w&&(x+=w.split(",").sort(p).map(function(e){return $("#"+searchType+"_crowdLvTuTagId").attr("seoCode")+e}).join("")),j&&(x+=j.split(",").sort(p).map(function(e){return $("#"+searchType+"_brandLvTuTagId").attr("seoCode")+e}).join("")),P&&(x+=P.split(",").sort(p).map(function(e){return $("#"+searchType+"_hotelBrandId").attr("seoCode")+e}).join("")),l&&(x=x+$("#homeSearch").attr("seoCode")+l),o&&(x=x+$("#channel").attr("seoCode")+o),i&&(x=x+$("#removeTab").attr("seoCode")+i),O=""==x?xe.replace(new RegExp("/"+searchType+"(-[a-zA-Z0-9]+)?"),"/"+searchType):xe.replace(new RegExp("/"+searchType+"(-[a-zA-Z0-9]+)?"),"/"+searchType+"-"+x)}else{var L="";s&&(L=L+"&keyword="+encodeURIComponent(s)),n&&(L=L+"&"+searchType+"_sort="+n),d&&(L=L+"&"+searchType+"_routeNum="+d),y&&(L=L+"&"+searchType+"_startMonths="+y),_&&(L=L+"&"+searchType+"_startDate="+_),u&&(L=L+"&"+searchType+"_endDate="+u),v&&(L=L+"&"+searchType+"_subjectId="+v),m&&(L=L+"&"+searchType+"_districtId="+m),f&&(L=L+"&"+searchType+"_price="+f),g&&(L=L+"&"+searchType+"_routeDestId="+g),S&&(L=L+"&"+searchType+"_viewPiont="+S),b&&(L=L+"&"+searchType+"_productType="+b),C&&(L=L+"&"+searchType+"_hotelStar="+C),k&&(L=L+"&"+searchType+"_playMethod="+k),I&&(L=L+"&"+searchType+"_traffic="+I),D&&(L=L+"&"+searchType+"_category="+D),N&&(L=L+"&"+searchType+"_productGrade="+N),w&&(L=L+"&"+searchType+"_crowdLvTuTagId="+w),j&&(L=L+"&"+searchType+"_brandLvTuTagId="+j),P&&(L=L+"&"+searchType+"_hotelBrandId="+P),l&&(L=L+"&homeSearch="+l),o&&(L=L+"&channel="+o),i&&(L=L+"&removeTab="+i),L=L.replace("&","?"),O=xe.replace(new RegExp(searchType+"(\\?\\S+)?"),searchType+L)}if(e.location.href===O&&!c)return;e.history.replaceState(null,"",O)}var E={keyword:s,homeSearch:l,channel:o,latitude:latitude,longitude:longitude,ajax:!0};needShare&&(E.from="league"),E[searchType+"_sort"]=n,E[searchType+"_routeNum"]=d,E[searchType+"_startMonths"]=y,E[searchType+"_startDate"]=_,E[searchType+"_endDate"]=u,E[searchType+"_subjectId"]=v,E[searchType+"_districtId"]=m,E[searchType+"_price"]=f,E[searchType+"_routeDestId"]=g,E[searchType+"_viewPiont"]=S,E[searchType+"_productType"]=b,E[searchType+"_hotelStar"]=C,E[searchType+"_playMethod"]=k,E[searchType+"_traffic"]=I,E[searchType+"_category"]=D,E[searchType+"_productGrade"]=N,E[searchType+"_crowdLvTuTagId"]=w,E[searchType+"_brandLvTuTagId"]=j,E[searchType+"_hotelBrandId"]=P,E[searchType+"_page"]=1,E[searchType+"_promote"]=M;var J=searchType;Ae=$.ajax({url:"/tour/"+searchType,data:E,type:"GET",beforeSend:function(){"confirm"===a&&$("#loading").show()},success:function(c){if($("#"+J+"_totalCount").val(c[J+"_totalCount"]),"item"===a&&"[]"===c[J+"_conditions"])if($("#"+J+"_price").val()&&Je(JSON.parse(filterParams[J+"_selected"]),"价格范围[0]").replace("price=","")!==$("#"+J+"_price").val()){var s=$('li[data-code="价格范围"] .filter-sub-ul li[data-code=""]');s.click(),s.click(),t()}else{if($("#"+J+"_startDate").val()&&filterParams[J+"_startDateSelected"]!==$("#"+J+"_startDate").val()){var o=$("#"+J+"_monthUl");o.find("li:first").click(),t()}if($("#"+J+"_endDate").val()&&filterParams[J+"_endDateSelected"]!==$("#"+J+"_endDate").val()){var o=$("#"+J+"_monthUl");o.find("li:first").click(),t()}}else J===searchType&&Te(c,J,!0,a,r);"confirm"===a&&(e.scrollTo(0,0),$("#"+J+"_container .masterplate-list").html(c.html),$("#"+J+"_page").val("1"),$e(c,J),T(),me(c,J,!1),ue(c),ve(c,J),_e(),Me(J,1),NativeUtil.isLessThan("8.0.8")&&document.querySelector(".cjFreetour")&&(document.querySelector(".cjFreetour").style.display="none"))},error:function(e,a,t){0!==e.readyState&&h()},complete:function(){$("#loading").hide(),$("#loading2").hide(),"confirm"===a&&Pe("filter"),Ae=null}})}function A(e,a,t){var r,c,s;try{r=JSON.parse(t)}catch(o){console.error(o),r={}}try{c=JSON.parse(a)}catch(o){console.error(o),c=[]}try{s=JSON.parse(e)}catch(o){console.error(o),s=""}Oe=new FilterBar([{tabName:"综合排序",selectedData:s,replace:!0,data:[{itemName:"综合排序",itemCode:"","default":!0},{itemName:"价格从低到高",itemCode:"18","default":!1},{itemName:"价格从高到低",itemCode:"19","default":!1},{itemName:"游玩天数从低到高",itemCode:"20","default":!1},{itemName:"游玩天数从高到低",itemCode:"21","default":!1}],callback:G},{tabName:"筛选",selectedData:r,data:c,callback:B}])}function B(e){var a=e.selected,t=e.type;"confirm"===t&&($("#ship_line").val(""),$("#ship_start").val(""),$("#ship_brand").val(""),$("#ship_month").val(""),$("#ship_district").val(""),$("#ship_ship").val(""),a&&Object.keys(a).length&&Object.keys(a).forEach(function(e){var t=e,r=a[e];"开航日期"==t?$("#ship_month").val(r.join(",").replace("month=","")):"邮轮航线"==t?$("#ship_line").val(r.join(",").replace("line=","")):"邮轮公司"==t?$("#ship_brand").val(r.join(",").replace("brand=","")):"出发港口"==t?$("#ship_start").val(r.join(",").replace("start=","")):"出发城市"==t?$("#ship_district").val(r.join(",").replace("district=","")):"邮轮名称"==t&&$("#ship_ship").val(r.join(",").replace("ship=",""))}),R())}function G(e){var t=e.selected,r=e.type;"confirm"===r&&($("#"+searchType+"_sort").val(a(t)),R())}function R(a){var t=$("#keyword").val(),r=$("#ship_sort").val(),c=$("#ship_line").val(),s=$("#ship_start").val(),o=$("#ship_brand").val(),l=$("#ship_month").val(),i=$("#ship_district").val(),n=$("#ship_ship").val(),d=$("#ship_promote").val(),p=$("#channel").val(),y=$("#homeSearch").val(),_=$("#removeTab").val(),u="";if("true"===isSEO){var v="";r&&(v=v+$("#ship_sort").attr("seoCode")+r),c&&(v=v+$("#ship_line").attr("seoCode")+c),s&&(v=v+$("#ship_start").attr("seoCode")+s),o&&(v=v+$("#ship_brand").attr("seoCode")+o),l&&(v=v+$("#ship_month").attr("seoCode")+l),i&&(v=v+$("#ship_district").attr("seoCode")+i),n&&(v=v+$("#ship_ship").attr("seoCode")+n),y&&(v=v+$("#homeSearch").attr("seoCode")+y),p&&(v=v+$("#channel").attr("seoCode")+p),_&&(v=v+$("#removeTab").attr("seoCode")+_),u=""==v?xe.replace(new RegExp("/youlun(-[a-zA-Z0-9]+)?"),"/youlun"):xe.replace(new RegExp("/youlun(-[a-zA-Z0-9]+)?"),"/youlun-"+v)}else{var m="";t&&(m=m+"&keyword="+encodeURIComponent(t)),r&&(m=m+"&ship_sort="+r),c&&(m=m+"&ship_line="+c),s&&(m=m+"&ship_start="+s),o&&(m=m+"&ship_brand="+o),l&&(m=m+"&ship_month="+l),i&&(m=m+"&ship_district="+i),n&&(m=m+"&ship_ship="+n),y&&(m=m+"&homeSearch="+y),p&&(m=m+"&channel="+p),_&&(m=m+"&removeTab="+_),m=m.replace("&","?"),u=xe.replace(new RegExp("youlun(\\?\\S+)?"),"youlun"+m)}if(e.location.href!==u||a){e.history.replaceState(null,"",u);var f={keyword:t,homeSearch:y,channel:p,ship_sort:r,ship_line:c,ship_start:s,ship_brand:o,ship_month:l,ship_district:i,ship_ship:n,ship_page:1,ship_promote:d,ajax:!0};needShare&&(f.from="league");var g=searchType;$.ajax({url:"/tour/youlun",data:f,type:"GET",beforeSend:function(){$("#loading").show()},success:function(a){e.scrollTo(0,0),$("#ship_container .masterplate-list").html(a.html),$("#ship_page").val("1"),$e(a,g),T(),me(a,g,!1),ue(a),ve(a,g),_e(),$("#"+g+"_totalCount").val(a[g+"_totalCount"]),Me(g,1)},error:function(){h()},complete:function(){$("#loading").hide(),Pe("filter")}})}}function H(e,a,t,r,c,s,o,l){var i,n,d,p,h,y,_,u;try{i=JSON.parse(e)}catch(v){console.error(v),i=""}try{n=JSON.parse(a)}catch(v){console.error(v),n=[]}try{d=JSON.parse(t)}catch(v){console.error(v),d={}}try{p=JSON.parse(r)}catch(v){console.error(v),p=[]}try{h=JSON.parse(c)}catch(v){console.error(v),h=""}try{y=JSON.parse(s)}catch(v){console.error(v),y=[]}try{_=JSON.parse(o)}catch(v){console.error(v),_=[]}try{u=JSON.parse(l)}catch(v){console.error(v),u=[]}Oe=new FilterBar([{tabName:"排序",selectedData:i,replace:!0,data:n,callback:q},{tabName:"星级价格",selectedData:d,data:p,callback:z},{tabName:"酒店设施",selectedData:_,data:u,multi:!0,callback:Z},{tabName:"酒店位置",selectedData:h,data:y,mutex:!0,callback:V}])}function q(e){var t=e.selected,r=e.type;"confirm"===r&&($("#"+searchType+"_sort").val(a(t)),W())}function z(e){var a=e.selected,t=e.type;"confirm"===t&&($("#"+searchType+"_price").val(""),$("#"+searchType+"_hotelStar").val(""),a&&Object.keys(a).length&&Object.keys(a).forEach(function(e){var t=e,r=a[e];"价格"==t?$("#"+searchType+"_price").val(r.join(",")):"星级"==t&&$("#"+searchType+"_hotelStar").val(r.join(","))}),W())}function V(e){var a=e.selected,t=e.type;if("confirm"===t){$("#"+searchType+"_landMarkIds").val("");var r=Object.keys(a),e=a[r[0]];e.length>0&&$("#"+searchType+"_landMarkIds").val(e[0]),W()}}function Z(e){var a=e.selected,t=e.type;"confirm"===t&&($("#"+searchType+"_facilities").val(a.join(",")),W())}function W(a){var t=$("#keyword").val(),r=$("#hotel_sort").val(),c=$("#hotel_price").val(),s=$("#hotel_hotelStar").val(),o=$("#hotel_landMarkIds").val(),l=$("#hotel_facilities").val(),i=$("#channel").val(),n=$("#homeSearch").val(),d=$("#removeTab").val(),y=$("#hotel_promote").val(),_="";if("true"===isSEO){var u="";r&&"0"!=r&&(u=u+$("#hotel_sort").attr("seoCode")+r),c&&(u=u+$("#hotel_price").attr("seoCode")+c),s&&(u+=s.split(",").sort(p).map(function(e){return $("#hotel_hotelStar").attr("seoCode")+e}).join("")),o&&(u+=o.split(",").sort(p).map(function(e){return $("#hotel_landMarkIds").attr("seoCode")+e}).join("")),l&&(u+=l.split(",").sort(p).map(function(e){return $("#hotel_facilities").attr("seoCode")+e}).join("")),n&&(u=u+$("#homeSearch").attr("seoCode")+n),i&&(u=u+$("#channel").attr("seoCode")+i),d&&(u=u+$("#removeTab").attr("seoCode")+d),_=""==u?xe.replace(/\/hotel(-[a-zA-Z0-9]+)?/,"/hotel"):xe.replace(/\/hotel(-[a-zA-Z0-9]+)?/,"/hotel-"+u)}else{var v="";t&&(v=v+"&keyword="+encodeURIComponent(t)),r&&(v=v+"&hotel_sort="+r),c&&(v=v+"&hotel_price="+c),s&&(v=v+"&hotel_hotelStar="+s),o&&(v=v+"&hotel_landMarkIds="+o),l&&(v=v+"&hotel_facilities="+l),n&&(v=v+"&homeSearch="+n),i&&(v=v+"&channel="+i),d&&(v=v+"&removeTab="+d),v=v.replace("&","?"),_=xe.replace(new RegExp(searchType+"(\\?\\S+)?"),searchType+v)}if(e.location.href!==_||a){e.history.replaceState(null,"",_);var m={keyword:t,hotel_sort:r,hotel_price:c,hotel_hotelStar:s,hotel_landMarkIds:o,hotel_facilities:l,homeSearch:n,channel:i,destDistrictId:destDistrictId,latitude:latitude,longitude:longitude,hotel_page:1,hotel_promote:y,ajax:!0};needShare&&(m.from="league");var f=searchType;$.ajax({url:"/tour/hotel",data:m,type:"GET",beforeSend:function(){$("#loading").show()},success:function(a){e.scrollTo(0,0),$("#hotel_container .masterplate-list").html(a.html),$("#hotel_page").val("1"),$e(a,f),T(),me(a,f,!1),ue(a),ve(a,f),_e(),$("#"+f+"_totalCount").val(a[f+"_totalCount"]),Me(f,1)},error:function(){h()},complete:function(){$("#loading").hide(),Pe("filter")}})}}function Y(e,a,t,r){var c,s,o,l;try{c=JSON.parse(e)}catch(i){console.error(i),c=!1}try{s=JSON.parse(a)}catch(i){console.error(i),s=""}try{o=JSON.parse(r)}catch(i){console.error(i),o={}}try{l=JSON.parse(t)}catch(i){console.error(i),l=[]}Oe=new FilterBar([{tabName:"综合排序",selectedData:s,replace:!0,data:[{itemName:"综合排序",itemCode:"","default":!0},{itemName:"距离从近到远",itemCode:"15","default":!1},{itemName:"价格从低到高",itemCode:"33","default":!1},{itemName:"价格从高到低",itemCode:"34","default":!1}],callback:X},{tabName:"今日可订",selectedData:c,callback:K},{tabName:"筛选",selectedData:o,data:l,callback:Q}])}function K(e){var a=e.selected,t=e.type;"confirm"===t&&($("#ticket_todayOrderableFlag").val(a?"1":""),ee())}function X(e){var t=e.selected,r=e.type;"confirm"===r&&($("#ticket_sort").val(a(t)),ee())}function Q(e){var a=e.selected,t=e.type;"confirm"===t&&($("#ticket_provinceId").val(""),$("#ticket_cityId").val(""),$("#ticket_countyId").val(""),$("#ticket_subjectId").val(""),$("#ticket_activeFlag").val(""),$("#ticket_promotionFlag").val(""),$("#ticket_starLevel").val(""),$("#ticket_distance").val(""),a&&Object.keys(a).length&&Object.keys(a).forEach(function(e){var t=a[e];if(t[0]&&t[0].indexOf("=")>=0){var r=t[0].split("=");$("#ticket_"+r[0]).val(r[1])}}),ee())}function ee(a){var t=$("#keyword").val(),r=$("#ticket_sort").val(),c=$("#ticket_todayOrderableFlag").val(),s=$("#ticket_provinceId").val(),o=$("#ticket_cityId").val(),l=$("#ticket_countyId").val(),i=$("#ticket_subjectId").val(),n=$("#ticket_activeFlag").val(),d=$("#ticket_promotionFlag").val(),p=$("#ticket_starLevel").val(),y=$("#channel").val(),_=$("#homeSearch").val(),u=$("#removeTab").val(),v=$("#ticket_promote").val(),m=$("#ticket_distance").val(),f="";if("true"===isSEO){var g="";r&&(g=g+$("#ticket_sort").attr("seoCode")+r),c&&(g=g+$("#ticket_todayOrderableFlag").attr("seoCode")+c),s&&(g=g+$("#ticket_provinceId").attr("seoCode")+s),o&&(g=g+$("#ticket_cityId").attr("seoCode")+o),l&&(g=g+$("#ticket_countyId").attr("seoCode")+l),i&&(g=g+$("#ticket_subjectId").attr("seoCode")+i),n&&(g=g+$("#ticket_activeFlag").attr("seoCode")+n),d&&(g=g+$("#ticket_promotionFlag").attr("seoCode")+d),p&&(g=g+$("#ticket_starLevel").attr("seoCode")+p),m&&(g=g+$("#ticket_distance").attr("seoCode")+m),_&&(g=g+$("#homeSearch").attr("seoCode")+_),y&&(g=g+$("#channel").attr("seoCode")+y),u&&(g=g+$("#removeTab").attr("seoCode")+u),f=""==g?xe.replace(new RegExp("/ticket(-[a-zA-Z0-9]+)?"),"/ticket"):xe.replace(new RegExp("/ticket(-[a-zA-Z0-9]+)?"),"/ticket-"+g)}else{var S="";t&&(S=S+"&keyword="+encodeURIComponent(t)),r&&(S=S+"&ticket_sort="+r),c&&(S=S+"&ticket_todayTicketFlag="+c),s&&(S=S+"&ticket_province="+s),o&&(S=S+"&ticket_city="+o),l&&(S=S+"&ticket_county="+l),i&&(S=S+"&ticket_subject="+i),n&&(S=S+"&ticket_activeFlag="+n),d&&(S=S+"&ticket_promotionFlag="+d),p&&(S=S+"&ticket_ticketStar="+p),m&&(S=S+"&ticket_distance="+m),_&&(S=S+"&homeSearch="+_),y&&(S=S+"&channel="+y),u&&(S=S+"&removeTab="+u),S=S.replace("&","?"),f=xe.replace(new RegExp("ticket(\\?\\S+)?"),searchTypes.t+S)}if(e.location.href!==f||a){e.history.replaceState(null,"",f);var b={keyword:t,ticket_sort:r,ticket_todayTicketFlag:c,ticket_province:s,ticket_city:o,ticket_county:l,ticket_subject:i,ticket_activeFlag:n,ticket_promotionFlag:d,ticket_ticketStar:p,channel:y,homeSearch:_,ticket_page:1,ticket_promote:v,ticket_distance:m,ajax:!0};needShare&&(b.from="league");var C=searchType;$.ajax({url:"/tour/ticket",data:b,type:"GET",beforeSend:function(){$("#loading").show()},success:function(a){e.scrollTo(0,0),$("#ticket_container .masterplate-list").html(a.html),$("#ticket_page").val("1"),$e(a,C),T(),me(a,C,!1),ue(a),ve(a,C),_e(),$("#"+C+"_totalCount").val(a[C+"_totalCount"]),Me(C,1)},error:function(){h()},complete:function(){$("#loading").hide(),Pe("filter")}})}}function ae(e,a,t,r,c){var s,o,l,i,n;try{s=JSON.parse(e)}catch(d){console.error(d),s=""}try{o=JSON.parse(t)}catch(d){console.error(d),o=""}try{l=JSON.parse(a)}catch(d){console.error(d),l=[]}try{i=JSON.parse(c)}catch(d){console.error(d),i=""}try{n=JSON.parse(r)}catch(d){console.error(d),n=[]}Oe=new FilterBar([{tabName:"综合排序",selectedData:s,replace:!0,data:[{itemName:"综合排序",itemCode:"","default":!0},{itemName:"价格从低到高",itemCode:"1","default":!1},{itemName:"价格从高到低",itemCode:"2","default":!1},{itemName:"出签率从高到低",itemCode:"3","default":!1}],callback:te},{tabName:"签证类型",selectedData:o,replace:!0,data:l,callback:re},{tabName:"领区",selectedData:i,replace:!0,data:n,callback:ce}])}function te(e){var t=e.selected,r=e.type;"confirm"===r&&($("#visa_sort").val(a(t)),se())}function re(e){var t=e.selected,r=e.type;"confirm"===r&&($("#visa_visaType").val(a(t)),se())}function ce(e){var t=e.selected,r=e.type;"confirm"===r&&($("#visa_rangeId").val(a(t)),se())}function se(a){var t=$("#keyword").val(),r=$("#visa_sort").val(),c=$("#visa_visaType").val(),s=$("#visa_rangeId").val(),o=$("#channel").val(),l=$("#homeSearch").val(),i=$("#removeTab").val(),n=$("#visa_promote").val(),d="";if("true"===isSEO){var p="";r&&(p=p+$("#visa_sort").attr("seoCode")+r),c&&(p=p+$("#visa_visaType").attr("seoCode")+c),s&&(p=p+$("#visa_rangeId").attr("seoCode")+s),l&&(p=p+$("#homeSearch").attr("seoCode")+l),o&&(p=p+$("#channel").attr("seoCode")+o),i&&(p=p+$("#removeTab").attr("seoCode")+i),d=""==p?xe.replace(new RegExp("/visa(-[a-zA-Z0-9]+)?"),"/visa"):xe.replace(new RegExp("/visa(-[a-zA-Z0-9]+)?"),"/visa-"+p)}else{var y="";t&&(y=y+"&keyword="+encodeURIComponent(t)),r&&(y=y+"&visa_sort="+r),c&&(y=y+"&visa_visaType="+c),s&&(y=y+"&visa_rangeId="+s),l&&(y=y+"&homeSearch="+l),o&&(y=y+"&channel="+o),i&&(y=y+"&removeTab="+i),y=y.replace("&","?"),d=xe.replace(new RegExp("visa(\\?\\S+)?"),searchTypes.v+y)}if(e.location.href!==d||a){e.history.replaceState(null,"",d);var _=searchType;$.ajax({url:"/tour/visa",data:{keyword:t,visa_sort:r,visa_visaType:c,visa_rangeId:s,homeSearch:l,channel:o,visa_page:1,visa_promote:n,ajax:!0},type:"GET",beforeSend:function(){$("#loading").show()},success:function(a){e.scrollTo(0,0),$("#visa_container .masterplate-list").html(a.html),$("#visa_page").val("1"),$e(a,_),T(),me(a,_,!1),ue(a),ve(a,_),_e(),$("#"+_+"_totalCount").val(a[_+"_totalCount"])},error:function(){h()},complete:function(){$("#loading").hide(),Pe("filter")}})}}function oe(e,a,t,r,c,s){var o,l,i,n,d,p;try{l=JSON.parse(a)}catch(h){console.error(h),l=""}try{o=JSON.parse(e)}catch(h){console.error(h),o=[]}try{n=JSON.parse(r)}catch(h){console.error(h),n=""}try{i=JSON.parse(t)}catch(h){console.error(h),i=""}try{p=JSON.parse(s)}catch(h){console.error(h),p=""}try{d=JSON.parse(c)}catch(h){console.error(h),d=""}Oe=new FilterBar([{tabName:"综合排序",selectedData:l,replace:!0,data:o,callback:ne},{tabName:"目的地",selectedData:p,data:d,replace:!0,replaceDefault:!1,callback:le},{tabName:"类型",selectedData:n,data:i,replace:!0,replaceDefault:!1,callback:ie}])}function le(e){var t=e.selected,r=e.type;"confirm"===r&&($("#localplay_province").val(""),$("#localplay_city").val(""),$("#localplay_county").val(""),$("#localplay_country").val(""),t.indexOf("province")>=0&&$("#localplay_province").val(a(t)),t.indexOf("city")>=0&&$("#localplay_city").val(a(t)),t.indexOf("county")>=0&&$("#localplay_county").val(a(t)),t.indexOf("country")>=0&&$("#localplay_country").val(a(t)),de())}function ie(e){var t=e.selected,r=e.type;"confirm"===r&&($("#localplay_playMethodTypeIds").val(a(t)),T(),de())}function ne(e){var t=e.selected,r=e.type;"confirm"===r&&($("#localplay_sort").val(a(t)),de())}function de(a,t){var r=$("#keyword").val(),c=$("#localplay_sort").val(),s=$("#localplay_province").val(),o=$("#localplay_city").val(),l=$("#localplay_county").val(),i=$("#localplay_country").val(),n=$("#localplay_playMethodTypeIds").val(),d=$("#channel").val(),p=$("#homeSearch").val(),y=$("#removeTab").val(),_=$("#localplay_promote").val(),u="";if("true"===isSEO){var v="";c&&(v=v+$("#localplay_sort").attr("seoCode")+c),s&&(v=v+$("#localplay_province").attr("seoCode")+s),o&&(v=v+$("#localplay_city").attr("seoCode")+o),l&&(v=v+$("#localplay_county").attr("seoCode")+l),i&&(v=v+$("#localplay_country").attr("seoCode")+i),n&&(v=v+$("#localplay_playMethodTypeIds").attr("seoCode")+n),p&&(v=v+$("#homeSearch").attr("seoCode")+p),d&&(v=v+$("#channel").attr("seoCode")+d),y&&(v=v+$("#removeTab").attr("seoCode")+y),u=""==v?xe.replace(new RegExp("/localplay(-[a-zA-Z0-9]+)?"),"/localplay"):xe.replace(new RegExp("/localplay(-[a-zA-Z0-9]+)?"),"/localplay-"+v)}else{var m="";r&&(m=m+"&keyword="+encodeURIComponent(r)),c&&(m=m+"&localplay_sort="+c),s&&(m=m+"&localplay_province="+s),o&&(m=m+"&localplay_city="+o),l&&(m=m+"&localplay_county="+l),i&&(m=m+"&localplay_country="+i),n&&(m=m+"&localplay_playMethodTypeIds="+n),p&&(m=m+"&homeSearch="+p),d&&(m=m+"&channel="+d),y&&(m=m+"&removeTab="+y),m=m.replace("&","?"),u=xe.replace(new RegExp("localplay(\\?\\S+)?"),searchTypes.u+m)}if(e.location.href!==u||t){e.history.replaceState(null,"",u);var f={keyword:r,localplay_sort:c,localplay_province:s,localplay_city:o,localplay_county:l,localplay_country:i,localplay_playMethodTypeIds:n,channel:d,homeSearch:p,localplay_page:1,localplay_promote:_,ajax:!0};needShare&&(f.from="league");var g=searchType;$.ajax({url:"/tour/localplay",data:f,type:"GET",beforeSend:function(){$("#loading").show()},success:function(t){e.scrollTo(0,0),$("#localplay_container .masterplate-list").html(t.html),$("#localplay_page").val("1"),a&&Te(t,g),$e(t,g),T(),me(t,g,!1),ue(t),ve(t,g),_e(),$("#"+g+"_totalCount").val(t[g+"_totalCount"]),Me(g,1)},error:function(){h()},complete:function(){$("#loading").hide(),Pe("filter")}})}}function pe(a,t){e.location.href=t+$(a).attr("href")}function he(a,t,r){navigator.userAgent.indexOf("LVMM")>=0?NativeUtil.goClass("SuperFree",{fromDistrictName:t,fromDistrictId:r}):e.location.href="https://m.lvmama.com/diy/?arrivalCity="+t+"&departureDestId="+r}function ye(e,a){u(!0,function(){e.eq(a+12).after($("#recommendDeparture")),$("#recommendDeparture").attr("data-around","add"),$("#recommendDeparture").css("display","block")})}function _e(){var a=$(e).scrollTop(),t=$(document).height(),r=$(e).height();0===a&&t===r&&"true"!=$("#"+searchType+"_isLastPage_ajax").val()&&0===$("#"+searchType+"_no_data").length&&u()}function ue(e){"lvyue"!=searchType&&(e.title&&(document.title=e.title),e.keywords&&$("#_keywords").attr("content",e.keywords),e.description&&$("#_description").attr("content",e.description))}function ve(e,a){"lvyue"!=searchType&&(a=a||searchType,e.title&&(tdkData[a].title=e.title),e.keywords&&(tdkData[a].keywords=e.keywords),e.description&&(tdkData[a].description=e.description))}function Te(e,a,t,r,c){switch(a=a||searchType,r=r||"confirm",a){case searchTypes.r:N({sortSelected:e.route_sortSelected,routeNumConditions:e.route_routeNumConditions,routeNumSelected:e.route_routeNumSelected,startDateSelected:e.route_startDateSelected,endDateSelected:e.route_endDateSelected,playMethodConditions:e.route_playMethodConditions,playMethodSelected:e.route_playMethodSelected,conditions:e.route_conditions,selected:e.route_selected,startDateConditions:e.route_startDateConditions},a,t,r,c);break;case searchTypes.lv:m(e.lvyue_numConditions,e.lvyue_conditions,e.lvyue_sort,e.lvyue_dayNum,e.lvyue_viewTheme);break;case searchTypes.s:b({sortSelected:e.scenictour_sortSelected,routeNumConditions:e.scenictour_routeNumConditions,routeNumSelected:e.scenictour_routeNumSelected,startDateSelected:e.scenictour_startDateSelected,endDateSelected:e.scenictour_endDateSelected,destIdConditions:e.scenictour_destIdConditions,destIdSelected:e.scenictour_destIdSelected,conditions:e.scenictour_conditions,selected:e.scenictour_selected,startDateConditions:e.scenictour_startDateConditions},a,t,r,c);break;case searchTypes.f:N({sortSelected:e.freetour_sortSelected,routeNumConditions:e.freetour_routeNumConditions,routeNumSelected:e.freetour_routeNumSelected,startDateSelected:e.freetour_startDateSelected,endDateSelected:e.freetour_endDateSelected,playMethodConditions:e.freetour_playMethodConditions,playMethodSelected:e.freetour_playMethodSelected,conditions:e.freetour_conditions,selected:e.freetour_selected,startDateConditions:e.freetour_startDateConditions},a,t,r,c);break;case searchTypes.p:N({sortSelected:e.play_sortSelected,routeNumConditions:e.play_routeNumConditions,routeNumSelected:e.play_routeNumSelected,startDateSelected:e.play_startDateSelected,endDateSelected:e.play_endDateSelected,playMethodConditions:e.play_playMethodConditions,playMethodSelected:e.play_playMethodSelected,conditions:e.play_conditions,selected:e.play_selected,startDateConditions:e.play_startDateConditions},a,t,r,c);break;case searchTypes.g:N({sortSelected:e.group_sortSelected,routeNumConditions:e.group_routeNumConditions,routeNumSelected:e.group_routeNumSelected,startDateSelected:e.group_startDateSelected,endDateSelected:e.group_endDateSelected,playMethodConditions:e.group_playMethodConditions,playMethodSelected:e.group_playMethodSelected,conditions:e.group_conditions,selected:e.group_selected,startDateConditions:e.group_startDateConditions},a,t,r,c);break;case searchTypes.l:O({sortSelected:e.local_sortSelected,routeNumConditions:e.local_routeNumConditions,routeNumSelected:e.local_routeNumSelected,startDateSelected:e.local_startDateSelected,endDateSelected:e.local_endDateSelected,playMethodConditions:e.local_playMethodConditions,playMethodSelected:e.local_playMethodSelected,conditions:e.local_conditions,selected:e.local_selected,startDateConditions:e.local_startDateConditions},a,t,r,c);break;case searchTypes.t:Y(e.ticket_todaySelected,e.ticket_sortSelected,e.ticket_conditions,e.ticket_selected);break;case searchTypes.y:A(e.ship_sortSelected,e.ship_conditions,e.ship_selected);break;case searchTypes.h:H(e.hotel_sortSelected,e.hotel_sortConditions,e.hotel_priceStarSelected,e.hotel_priceStarConditions,e.hotel_landMarkIdsSelected,e.hotel_landMarkIdsConditions,e.hotel_facilitiesSelected,e.hotel_facilitiesConditions);break;case searchTypes.v:ae(e.visa_sortSelected,e.visa_visaTypesConditions,e.visa_visaTypesSelected,e.visa_rangeTypesConditions,e.visa_rangeTypesSelected);break;case searchTypes.u:oe(e.localplay_sortConditions,e.localplay_sortSelected,e.localplay_playMethodTypeIdsConditions,e.localplay_playMethodTypeIdsSelected,e.localplay_destConditions,e.localplay_destSelected);break;case searchTypes.a:N({sortSelected:e.around_sortSelected,routeNumConditions:e.around_routeNumConditions,routeNumSelected:e.around_routeNumSelected,startDateSelected:e.around_startDateSelected,endDateSelected:e.around_endDateSelected,playMethodConditions:e.around_playMethodConditions,playMethodSelected:e.around_playMethodSelected,conditions:e.around_conditions,selected:e.around_selected,startDateConditions:e.around_startDateConditions},a,t,r,c)}}function me(e,a,t){switch(a=a||searchType,t=void 0===t||t,a){case searchTypes.lv:t||(filterParams[a+"_numConditions"]=e[a+"_numConditions"],filterParams[a+"_conditions"]=e[a+"_conditions"]),filterParams[a+"_viewTheme"]=e[a+"_viewTheme"],filterParams[a+"_sort"]=e[a+"_sort"],filterParams[a+"_dayNum"]=e[a+"_dayNum"];break;case searchTypes.s:t||(filterParams[a+"_routeNumConditions"]=e[a+"_routeNumConditions"],filterParams[a+"_destIdConditions"]=e[a+"_destIdConditions"],filterParams[a+"_conditions"]=e[a+"_conditions"],filterParams[a+"_startDateConditions"]=e[a+"_startDateConditions"]),filterParams[a+"_sortSelected"]=e[a+"_sortSelected"],filterParams[a+"_routeNumSelected"]=e[a+"_routeNumSelected"],filterParams[a+"_destIdSelected"]=e[a+"_destIdSelected"],filterParams[a+"_startDateSelected"]=e[a+"_startDateSelected"],filterParams[a+"_endDateSelected"]=e[a+"_endDateSelected"],filterParams[a+"_selected"]=e[a+"_selected"];break;case searchTypes.r:case searchTypes.f:case searchTypes.p:case searchTypes.g:case searchTypes.a:t||(filterParams[a+"_routeNumConditions"]=e[a+"_routeNumConditions"],filterParams[a+"_playMethodConditions"]=e[a+"_playMethodConditions"],filterParams[a+"_conditions"]=e[a+"_conditions"],filterParams[a+"_startDateConditions"]=e[a+"_startDateConditions"]),filterParams[a+"_sortSelected"]=e[a+"_sortSelected"],filterParams[a+"_routeNumSelected"]=e[a+"_routeNumSelected"],filterParams[a+"_playMethodSelected"]=e[a+"_playMethodSelected"],filterParams[a+"_startDateSelected"]=e[a+"_startDateSelected"],filterParams[a+"_endDateSelected"]=e[a+"_endDateSelected"],filterParams[a+"_selected"]=e[a+"_selected"];break;case searchTypes.l:t||(filterParams[a+"_routeNumConditions"]=e[a+"_routeNumConditions"],filterParams[a+"_playMethodConditions"]=e[a+"_playMethodConditions"],filterParams[a+"_conditions"]=e[a+"_conditions"],filterParams[a+"_startDateConditions"]=e[a+"_startDateConditions"]),filterParams[a+"_sortSelected"]=e[a+"_sortSelected"],filterParams[a+"_routeNumSelected"]=e[a+"_routeNumSelected"],filterParams[a+"_playMethodSelected"]=e[a+"_playMethodSelected"],filterParams[a+"_startDateSelected"]=e[a+"_startDateSelected"],filterParams[a+"_endDateSelected"]=e[a+"_endDateSelected"],filterParams[a+"_selected"]=e[a+"_selected"];break;case searchTypes.t:t||(filterParams[a+"_conditions"]=e[a+"_conditions"]),filterParams[a+"_todaySelected"]=e[a+"_todaySelected"],filterParams[a+"_sortSelected"]=e[a+"_sortSelected"],filterParams[a+"_selected"]=e[a+"_selected"];break;case searchTypes.y:t||(filterParams[a+"_conditions"]=e[a+"_conditions"]),filterParams[a+"_sortSelected"]=e[a+"_sortSelected"],filterParams[a+"_selected"]=e[a+"_selected"];break;case searchTypes.h:t||(filterParams[a+"_sortConditions"]=e[a+"_sortConditions"],filterParams[a+"_priceStarConditions"]=e[a+"_priceStarConditions"],filterParams[a+"_landMarkIdsConditions"]=e[a+"_landMarkIdsConditions"],filterParams[a+"_facilitiesConditions"]=e[a+"_facilitiesConditions"]),filterParams[a+"_sortSelected"]=e[a+"_sortSelected"],filterParams[a+"_priceStarSelected"]=e[a+"_priceStarSelected"],filterParams[a+"_landMarkIdsSelected"]=e[a+"_landMarkIdsSelected"],filterParams[a+"_facilitiesSelected"]=e[a+"_facilitiesSelected"];break;case searchTypes.v:t||(filterParams[a+"_visaTypesConditions"]=e[a+"_visaTypesConditions"],filterParams[a+"_rangeTypesConditions"]=e[a+"_rangeTypesConditions"]),filterParams[a+"_sortSelected"]=e[a+"_sortSelected"],filterParams[a+"_visaTypesSelected"]=e[a+"_visaTypesSelected"],filterParams[a+"_rangeTypesSelected"]=e[a+"_rangeTypesSelected"];break;case searchTypes.u:t||(filterParams[a+"_sortConditions"]=e[a+"_sortConditions"],filterParams[a+"_playMethodTypeIdsConditions"]=e[a+"_playMethodTypeIdsConditions"],filterParams[a+"_destConditions"]=e[a+"_destConditions"]),filterParams[a+"_sortSelected"]=e[a+"_sortSelected"],filterParams[a+"_playMethodTypeIdsSelected"]=e[a+"_playMethodTypeIdsSelected"],filterParams[a+"_destSelected"]=e[a+"_destSelected"]}}function $e(e,a){var t,r,c,s="",o=[];if(["route","freetour","play","group","local"].indexOf(a)>=0){try{t=JSON.parse(e[a+"_playMethodConditions"])}catch(l){console.error(l),t=[]}t.length>0&&(o=t.filter(function(e){return"不限"!=e.itemName&&e.itemCode}))}else if("localplay"===a){try{t=JSON.parse(e[a+"_playMethodTypeIdsConditions"])}catch(l){console.error(l),t=[]}t.length>0&&(o=t.filter(function(e){return"不限"!=e.itemName&&e.itemCode}))}try{c=e.group_lvHappy}catch(l){console.error(l),c=[]}try{r=e[a+"_promote"]}catch(l){console.error(l),r={}}o.length>0||r&&r.itemCode||c&&c.length>0?(s+='<ul id="search_'+a+'_top" class="search_top_filter">',r&&r.itemCode&&(s+=r.itemImageUrl?'<li class="isPromote" data-code="'+r.itemCode+'" style="width: 74px;background-image: url('+r.itemImageUrl+')"></li>':'<li class="isPromote" data-code="'+r.itemCode+'">'+r.itemName+"</li>"),c&&c.length>0&&(s+='<li data-code="'+c[0].itemCode+'">'+c[0].itemName+"</li>"),o.forEach(function(e){s+='<li data-code="'+e.itemCode+'">'+e.itemName+"</li>"}),s+="</ul>",$("#search_"+a+"_top").remove(),$("#"+a+"_container .searchList").prepend(s),$("#"+a+"_container .masterplate-list").addClass("list-padding-top")):($("#search_"+a+"_top").remove(),$("#"+a+"_container .masterplate-list").removeClass("list-padding-top"));
}function fe(a){a=a||searchType;var t={keyword:$("#keyword").val(),homeSearch:$("#homeSearch").val(),channel:$("#channel").val(),latitude:latitude,longitude:longitude,ajax:!0};t[a+"_page"]=1,a===searchTypes.h&&(t.destDistrictId=destDistrictId),needShare&&(t.from="league"),$.ajax({url:"/tour/"+("ship"===a?"youlun":a),data:t,type:"GET",success:function(t){e.scrollTo(0,0),$("#"+a+"_container .masterplate-list").html(t.html),$("#"+a+"_totalCount").val(t[a+"_totalCount"]),$e(t,a),a===searchType&&Te(t,a),me(t,a,!1),a===searchType&&ue(t),ve(t,a),_e(),NativeUtil.isLessThan("8.0.8")&&document.querySelector(".cjFreetour")&&(document.querySelector(".cjFreetour").style.display="none"),Me(a,1)},error:function(){h()},complete:function(){$("#"+a+"_loader").css("display","none"),$(".filter-wrap").css("opacity","1"),Pe("switch")}})}function ge(a,t,r,c){if($("html").removeClass("noscroll"),$("body").removeClass("open").removeClass("noscroll"),a!==searchType){Re[searchType]=document.body.scrollTop,He[searchType]=e.location.href;var s=He[a];e.history.replaceState(null,"",s),xe=s,searchType=a,Ne(searchType),$("#tab_"+searchType).addClass("active").siblings().removeClass("active"),setTimeout(function(){$("#panel_"+searchType).addClass("active").siblings().removeClass("active")},200),$(".tabChange").hide(),$("#"+searchType+"_container").show(),Oe&&Oe.hidePanel(!1,!1),$("#"+searchType+"_container .masterplate-list").html()?(Ee=!0,e.scrollTo(0,Re[searchType]),setTimeout(function(){Ee=!1},100),Te(filterParams,a),ue(tdkData[a]),Pe("switch")):($("#"+searchType+"_page").val("1"),Ee=!0,e.scrollTo(0,0),setTimeout(function(){Ee=!1},100),$(".filter-wrap").css("opacity","0"),searchType!==searchTypes.h?fe(a):e.navigator.userAgent.indexOf("Windows Phone")!=-1&&e.navigator.userAgent.indexOf("WebView")!=-1?fe(a):latitude?fe(a):positionUtil.getLocalPosition(function(e){latitude=e.latitude,longitude=e.longitude,y("latitude",latitude),y("longitude",longitude),fe(a)}),De())}}function Se(e){ge(e);var a=document.getElementById("tab_"+e);a.scrollIntoView()}function be(a){$(".nav-down").click(),e.location.href=a.href}function Ce(e,a){var t="";switch(e){case searchTypes.s:t=a?"Scenic&hotel":"酒+景";break;case searchTypes.f:t=a?"Flight&hotel":"机+酒";break;case searchTypes.p:t=a?"Traffic&X":"交通+服务";break;case searchTypes.g:t=a?"Packagetour":"跟团游";break;case searchTypes.l:t=a?"Localtour":"当地游";break;case searchTypes.t:t=a?"Ticket":"门票";break;case searchTypes.y:t=a?"CruiseLines":"邮轮";break;case searchTypes.h:t=a?"Hotel":"酒店";break;case searchTypes.v:t=a?"Visa":"签证";break;case searchTypes.u:t=a?"Show":"演出票"}return t}function ke(){var e="";switch(homeSearch){case"2":e="周边游";break;case"3":e="国内游";break;case"4":case"6":e="出境游";break;case"7":e="签证";break;case"8":e="邮轮";break;default:e="首页"}return e}function Ie(e){var a="";switch(homeSearch){case"2":a=e?"AroundHomepage":"周边游子频道搜索";break;case"3":a=e?"InboundHomepage":"国内游子频道搜索";break;case"4":a=e?"AbroadHomepage":"出境游子频道搜索";break;case"7":a=e?"VisaHomepage":"签证子频道搜索";break;default:a=e?"Homepage":"首页综合搜索"}return a}function De(){statisticsUtil.execStatis("page",{pi:"搜索_"+ke()+"搜索_"+stationName+"_"+Ce(searchType)+"_"+keyword,cg:"Search_"+Ie(!0)+"_"+Ce(searchType,!0),attributes:"-_--_--_-路径页面"})}function Ne(e){statisticsUtil.execStatis("element",{eid:Ie()+"_"+Ce(e),ecat:Ie()})}function we(e){statisticsUtil.execStatis("element",{eid:"搜索-"+ke()+"-"+Ce(searchType)+"-"+e,ecat:"wap搜索结果"})}function je(){for(var e={},a=$("input[id^="+searchType+"]"),t=0;t<a.length;t++){var r=$(a[t]).attr("id").replace(searchType+"_",""),c=$(a[t]).val();["page","totalCount","isLastPage_ajax"].indexOf(r)===-1&&c&&("routeDestId"===r&&(r="destId"),"hotel"===searchType&&"hotelStar"===r&&(c=c.split(",").map(function(e){return Ze(e)}).join(",")),e[r]=c)}return JSON.stringify(e)}function Pe(e){statisticsUtil.losc.cmCreateClickTag("search",e,{sk:$("#keyword").val(),ps:$("#"+searchType+"_totalCount").val()||"0",lab:searchType.toUpperCase(),pag:$("#"+searchType+"_page").val()||"1",cp:je()})}function Me(e,a){needShare&&setTimeout(function(){var t=e+"_searchListUl"+a.toString();$("ul#"+t+" > li").each(function(t,r){var c=$(r).data("product-id"),s=We[e];if(!c||!s)return void console.error("CPS佣金计算错误！type, pageIndex:",e,a);var o="https://munion.lvmama.com/cpsApp/cpsAppProductCommission/searchCommissionPrice?categoryName="+s+"&productId="+c;$.get("https://m.lvmama.com/proxy?url="+encodeURIComponent(o),function(e){"1"===e.code?e.data&&e.data.commissionList&&e.data.commissionList[0]&&e.data.commissionList[0].commissionPrice?$(r).find(".ml-pro-share p").text("最高可赚¥"+e.data.commissionList[0].commissionPrice+"元"):console.warn("CPS佣金接口未返回正确金额！data:",e):console.error("CPS佣金接口调用失败！data:",e)})})},300)}Array.prototype.remove=function(e){if(isNaN(e)||e>this.length)return!1;for(var a=0,t=0;a<this.length;a++)this[a]!=this[e]&&(this[t++]=this[a]);this.length-=1};var Oe,xe=e.location.href,Le=!1,Ee=!1,Je=function(e,a,t){var r=void 0!==t?t:"";if(null===e||"object"!==("undefined"==typeof e?"undefined":_typeof(e))||"string"!=typeof a)return r;a=a.split(/[\.\[\]]/).filter(function(e){return""!=e});for(var c,s=-1,o=a.length,l=!0;++s<o;){if(c=a[s],!Object.prototype.hasOwnProperty.call(e,c)){l=!1;break}e=e[c]}return l&&(r=e),r};$("#tab_"+searchType).addClass("active"),$("#panel_"+searchType).addClass("active");var Ue=document.getElementById("tab_"+searchType);Ue&&Ue.scrollIntoView(),e.scrollTo(0,0),$("#keywordInput").on("click",function(){/^http(s)?:\/\/m\.lvmama\.com/.test(headSkipUrl)||(headSkipUrl="https://m.lvmama.com"+headSkipUrl),e.NativeUtil&&NativeUtil.isLVMM&&NativeUtil.isGreaterThan("7.9.1")?NativeUtil.goClass("openNewWebView",{url:headSkipUrl,title:"综合搜索"}):e.location.href=headSkipUrl}),Te(filterParams);var Fe;$(".start-time-mask").on("click",function(){Fe&&Fe.close(),$(".start-time-mask").hide()}),e.showStartTime=l,e.monthClick=i,e.monthMoreClick=n,$(".p4-clear").live("click",function(){$("#"+searchType+'_monthUl li[code=""]').addClass("active").siblings().removeClass("active"),d()}),$(".lvft-mask").live("click",function(){Fe&&Fe.close()}),T(),["route","scenictour","freetour","play","group","local"].forEach(function(e){$("#search_"+e+"_top li").live("click",function(a){if(!(a.target.className.indexOf("isPromote")>-1)){if(a.target.dataset.code.indexOf("brandLvTuTagId")>-1){$(this).toggleClass("active");var t=$(".filter-panel ul li[data-code=自主品牌] .filter-sub-li").find("div");return void t.each(function(e){"开心驴行"==$(t[e]).find("span").text()&&(navigator.userAgent.indexOf("Android")>-1||navigator.userAgent.indexOf("Adr")>-1?($(t[e]).click(),$(t[e]).click(),$(t[e]).click(),$(".filter-confirm").eq($(".filter-confirm").length-1).click(),$(".filter-confirm").eq($(".filter-confirm").length-1).click(),$(".filter-confirm").eq($(".filter-confirm").length-1).click()):($(t[e]).click(),$(t[e]).click(),$(".filter-confirm").eq($(".filter-confirm").length-1).click(),$(".filter-confirm").eq($(".filter-confirm").length-1).click()))})}var r=a.target.dataset.code.split("=")[0];$(this).toggleClass("active");var c=[],s=[],o=0,l=$("#search_"+e+"_top li"),i=l.length;for($("#"+e+"_"+r).val("");o<i;o++)$(l[o]).hasClass("active")&&!$(l[o]).hasClass("isPromote")&&l[o].dataset.code.indexOf("brandLvTuTagId")<0&&(c.push($(l[o]).data("code").replace(r+"=","")),s.push($(l[o]).data("code")));c.length>0&&$("#"+e+"_"+r).val(c.join(",")),Oe&&(Oe.cache[2]=s),F()}})}),$("#search_localplay_top li").live("click",function(e){if(!(e.target.className.indexOf("isPromote")>-1)){$(this).hasClass("active")?$(this).removeClass("active"):($("#search_localplay_top li").removeClass("active"),$(this).addClass("active"));var a=[],t=0,r=$("#search_localplay_top li"),c=r.length;for($("#localplay_playMethodTypeIds").val("");t<c;t++)$(r[t]).hasClass("active")&&!$(r[t]).hasClass("isPromote")&&a.push($(r[t]).data("code").replace("playMethodTypeIds=",""));a.length>0&&$("#"+searchType+"_playMethodTypeIds").val(a.join(",")),de(!0)}}),document.querySelector("body").addEventListener("click",function(e){if(e.target.className.indexOf("isPromote")>-1)switch($(e.target).hasClass("active")?($(e.target).removeClass("active"),$("#"+searchType+"_promote").val("")):($(e.target).siblings().removeClass("active"),$(e.target).addClass("active"),$("#"+searchType+"_promote").val(e.target.dataset.code)),searchType){case"ship":R(!0);break;case"hotel":W(!0);break;case"ticket":ee(!0);break;case"visa":se(!0);break;case"localplay":de(!1,!0);break;default:F("","",!0)}});var Ae;latitude?searchType===searchTypes.h&&$("#hotel_container .masterplate-list").show():positionUtil.getLocalPosition(function(a){latitude=a.latitude,longitude=a.longitude,y("latitude",latitude),y("longitude",longitude),searchType===searchTypes.h&&(e.navigator.userAgent.indexOf("Windows Phone")!=-1&&e.navigator.userAgent.indexOf("WebView")!=-1?$("#hotel_container .masterplate-list").show():($("#hotel_container .masterplate-list").empty(),Be(1),$("#hotel_container .masterplate-list").show()))});var Be=function(e){var a=$("#keyword").val(),t=$("#hotel_sort").val(),r=$("#hotel_price").val(),c=$("#hotel_hotelStar").val(),s=$("#hotel_landMarkIds").val(),o=$("#hotel_facilities").val(),l=($("#homeSearch").val(),$("#channel").val()),i=$("#hotel_promote").val(),n={keyword:a,hotel_sort:t,hotel_price:r,hotel_hotelStar:c,hotel_landMarkIds:s,hotel_facilities:o,hotel_promote:i,channel:l,destDistrictId:destDistrictId,latitude:latitude,longitude:longitude,hotel_page:e,ajax:!0};needShare&&(n.from="league"),$.ajax({url:"/tour/hotel",data:n,async:!1,type:"GET",beforeSend:function(){$("#hotel_onbuttom").show()},success:function(a){a.html.indexOf("search-null")>-1?"1"!=e&&h():($("#hotel_container .masterplate-list").append(a.html),$("#hotel_page").val(e),Me("hotel",e))},error:function(){h()},complete:function(){$("#hotel_onbuttom").hide(),Le=!1}})};e.changeUrl=pe,e.cjFreetourClick=he,$(".clear").live("click",function(){$(".filter").removeClass("chosen")}),$(".cancel").live("click",function(){$(".filter").removeClass("selected")});var Ge=!1;setTimeout(function(){$(e).scroll(function(){if(!Ee){var e=$("#route_container .masterplate-list li"),a=$("#route_container .masterplate-list li i.recommend").length,t=$(this).scrollTop(),r=$(document).height(),c=$(this).height();if(t>0&&t+c+115>=r){var s=$("#"+searchType+"_isLastPage_ajax").val();"true"!=s&&Le===!1&&(Le=!0,u())}!Ge&&e.length>a+13&&"add"!=$("#recommendDeparture").attr("data-around")&&(Ge=!0,ye(e,a))}})},100),document.querySelector("body").addEventListener("click",function(a){if("rList"==a.target.parentNode.className){var t=$(a.target).text();e.history.replaceState({code:"recom"},null,"//m.lvmama.com/mainSearch/preSearch.htm?homeSearch=10&searchType=route&keyword="+t);var r=e.localStorage.getItem("main_search_records");for(r=null==r||""==r?[]:r.split(","),$.each(r,function(e,a){if(a==t)return r.remove(e),!1});r.length>=10;)r.shift();r.push(t),e.localStorage.setItem("main_search_records",r.join(",")),e.location.reload()}},!1),_e();var Re={},He={};for(var qe in searchTypes)Object.prototype.hasOwnProperty.call(searchTypes,qe)&&(Re[searchTypes[qe]]=0,He[searchTypes[qe]]=e.location.protocol+"//"+e.location.host+$("#tab_"+searchTypes[qe]+" a").attr("href"));He[searchType]=e.location.href,e.tabSwitch=ge,e.tabSwitchInPanel=Se,e.tabSwitchLink=be,$(".nav-down").on("click",function(e){$("body").hasClass("open")?($("html").removeClass("noscroll"),$("body").removeClass("open").removeClass("noscroll")):($("html").addClass("noscroll"),$("body").addClass("open").addClass("noscroll")),Oe&&Oe.hidePanel(!1)}),$(".pull-cover").on("click",function(){$("html").removeClass("noscroll"),$("body").removeClass("open").removeClass("noscroll")}),$(".scenictourButton").live("click",function(e){var a=e.target.nextElementSibling;$(".scenictourInfoShow").css("display","none"),a.style.display="block"}),$(".scenictourInfoShow_close").live("click",function(e){var a=e.target.parentElement;a.style.display="none"}),$(".scenictourInfoShow_tab span").live("click",function(e){var a=$(this).parent().children().index(this);$(this).siblings().removeClass("active"),$(this).addClass("active"),$($(this).parent()).siblings().css("display","none"),$($(this).parent()).siblings().eq(a).css("display","block")}),searchType==searchTypes.lv&&statisticsUtil.execStatis("page",{pi:"驴悦-搜索结果页_"+keyword,cg:"lvyueSearchReasult",attributes:"-_--_--_-路径页面"}),De(),e.cmRecordTab=Ne,$(document).on("click",".btn-type1",function(){searchType===searchTypes.t&&we("今日可订")}),$(document).on("click",".p2-ul li, .p4-ul li",function(){var e=$.trim($(this).text());we(e)});var ze=0,Ve=0;$(e).scroll(function(){Ve=$(e).scrollTop(),0===$(".lvft-panel:visible").length&&!Ee,setTimeout(function(){ze=Ve},0)}),e.onpagehide=function(a){a.persisted||e.scrollTo(0,0)},e.onpageshow=function(e){e.persisted||$("#"+searchType+"_page").val("1")};var Ze=function(e){var a={5:"100101",4:"102103",3:"104105",2:"106107"};return a[e]};e.filterCm=Pe,statisticsUtil.losc.cmCreatePageviewTag("search",{ps:$("#"+searchType+"_totalCount").val()||"0",sk:keyword,lab:searchType.toUpperCase(),pag:"1"}),Pe("filter"),Pe("switch"),e.clickCpsShare=function(a){var t=$(a).attr("href"),r=function(){var a=encodeURIComponent("https://munion.lvmama.com/league/pages/login/"),t=encodeURIComponent("https://m.lvmama.com/wx/league?account=league&backUrl="+a);e.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx9c99e5582ab551d4&redirect_uri="+t+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect"};$.get("https://m.lvmama.com/proxy?url=https%3A%2F%2Fmunion.lvmama.com%2FcpsApp%2Flogin%2FifLogin",function(a){"1"===a.code?e.location.href=t:r()})};var We={route:"ROUTE",scenictour:"HOTEL_VIEW",freetour:"ROUTE_FREEDOM",play:"PLAY",group:"ROUTE_GROUP",local:"ROUTE_LOCAL",ticket:"TICKET",hotel:"HOTEL",ship:"SHIP",localplay:"LOCALPLAY",around:"AROUND"};Me(searchType,1)}(window);